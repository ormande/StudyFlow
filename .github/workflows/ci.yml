name: Continuous Integration (CI)

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build_and_test:
    name: Build & Type Check
    runs-on: ubuntu-latest
    
    steps:
      - name: â¬‡ï¸ Checkout do CÃ³digo
        uses: actions/checkout@v4
      
      - name: âš™ï¸ Configurar Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # VersÃ£o LTS recomendada
          cache: 'npm' # Cache do npm para builds mais rÃ¡pidos
      
      - name: ğŸ“¦ Instalar DependÃªncias (npm ci)
        # Usa 'npm ci' para builds de CI, garantindo que o lockfile seja usado
        run: npm ci
      
      - name: ğŸ” Verificar Tipagem TypeScript
        # Executa o script 'typecheck' do package.json (tsc --noEmit)
        run: npm run typecheck
      
      - name: ğŸ—ï¸ Fazer Build para ProduÃ§Ã£o
        # Executa o build final (e verifica se ele passa)
        run: npm run build
        env:
          # VariÃ¡veis dummy necessÃ¡rias para o build passar
          # O cÃ³digo verifica se essas variÃ¡veis existem em src/lib/supabase.ts
          # Valores reais serÃ£o configurados no Vercel durante o deploy
          VITE_SUPABASE_URL: 'https://dummy.supabase.co'
          VITE_SUPABASE_ANON_KEY: 'dummy_key_for_ci_build'
